<div ng-if="selectedProgramStage && !eventRegistration && !editingEventInFull" class="small-vertical-spacing">
    <i ng-if="!eventFetched && selectedOptions.length === selectedCategories.length && optionsReady" class="fa fa-spinner fa-spin fa-2x"></i>    
    <div ng-if="eventFetched" ng-switch="dhis2Events.length">                        
        <div ng-switch-when="undefined">
            <h4>
                {{'empty_event_list'| translate}}
            </h4>            
        </div>                        
        <div ng-switch-when="0">  
            <h4 ng-if="eventFetched">
                {{'empty_event_list'| translate}}
            </h4>
            <div ng-if="!filterTextExist()">
                <button class="btn btn-success" ng-click="resetFilter()">
                    {{'back_to_list' | translate}}
                </button>
            </div>
        </div>
        <div ng-switch-default>           
            <div class="vertical-spacing small-vertical-spacing">                
                <span class="alert alert-default remove-default-padding horizontal-spacing label-font">
                    <label class="btn-default no-bold" ng-disabled="true">{{'registered_events'| translate}} <span class="small-horizontal-spacing" ng-if="pager.total">({{'total' | translate}}:  {{pager.total}})</span></label>
                </span>
                <span class="long-horizontal-spacing hideInPrint">                        
                    <span ng-if="dhis2Events.length > 0 && !eventRegistration && !editingEventInFull && !editingEventInGrid">
                        <span class="dropdown">
                            <label class="btn btn-default" data-toggle="dropdown" class="dropdown-toggle"><i class="fa fa-download"></i></label>
                            <ul style="margin-top: 10px !important;" class="dropdown-menu">
                                <li><h6 class="dropdown-header">Download as</h6></li>
                                <li class="divider"></li>
                                <li ng-repeat="format in model.exportFormats">
                                    <a href ng-if="format==='CSV'" filename="eventList.csv" ng-csv="getCSVExportList()">{{format}}</a>
                                    <a href ng-if="format!=='CSV'" ng-click="getExportList(format)">{{format}}</a>
                                </li>
                            </ul>
                        </span>
                        <label class="btn btn-default horizontal-spacing" ng-click="showHideColumns()" ng-attr-title="{{'show_hide_columns'| translate}}">
                            <i class="fa fa-table label-font"></i>
                        </label>
                    </span>                        
                    <label class="btn btn-default" ng-if="editingEventInGrid" ng-click="showEventList()" ng-attr-title="{{'close_editing'| translate}}">
                        <i class="fa fa-times-circle label-font"></i>
                    </label>
                </span>
            </div>
            

            <!-- context menu for event grid -->
            <div id="contextMenu" class="contextMenu" style="width: 180px;">
                <ul id="contextMenuItems" class="contextMenuItems">
                    <li ng-if="!selectedProgram.access.data.write"><a href ng-click="showEditEventInFull()"><i class="fa fa-eye"></i>&nbsp;&nbsp;{{'show'| translate}}</a></li>
                    <li ng-if="selectedProgram.access.data.write"><a href ng-click="showEditEventInFull()"><i class="fa fa-edit"></i>&nbsp;&nbsp;{{'edit'| translate}}</a></li>
                    <li ng-if="selectedProgram.access.data.write"><a href ng-click="showEditEventInGrid()"><i class="fa fa-edit"></i>&nbsp;&nbsp;{{'edit_in_grid'| translate}}</a></li>
                    <li><a href ng-click="showAuditHistory()"><i class="glyphicon glyphicon-user"></i>&nbsp;&nbsp;{{'audit_history'| translate}}</a></li>
                    <li class="divider" ng-if="hasDataWrite()">&nbsp;</li>
                    <li ng-if="hasDataWrite()"><a href ng-click="removeEvent()"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;{{'remove'| translate}}</a></li>                                       
                </ul>
            </div>
            <!-- context menu ends -->                            

            <!-- grid begins -->
            <div class="small-vertical-spacing">
                <ng-form name="outerListForm" novalidate>

                    <table class="listTable dhis2-table-striped-border dhis2-table-hover">
                        <thead>                        
                            <tr>
                                <th ng-repeat="eventGridColumn in eventGridColumns | filter: {show: true}" ng-if="eventGridColumn.id !== 'comment'">
                                    <!-- sort icon begins -->                                
                                    <span ng-hide="eventGridColumn.showFilter" class="bold" ng-click="sortEventGrid(eventGridColumn)">
                                        <span class="fa-stack">
                                            <span ng-class="{true: 'red'} [sortHeader.id === eventGridColumn.id && !reverse]"><i class="fa fa-sort-asc fa-stack-1x"></i></span>
                                            <span ng-class="{true: 'red'} [sortHeader.id === eventGridColumn.id && reverse]"><i class="fa fa-sort-desc fa-stack-1x"></i></span>
                                        </span>
                                        <span ng-if="eventGridColumn.id !== 'uid'">{{eventGridColumn.displayName}}</span>
                                        <span ng-if="eventGridColumn.id == 'uid'">{{eventGridColumn.displayName | translate}}</span>
                                    </span>
                                    <!-- sort icon ends -->

                                    <!-- filter icon begins -->
                                    <span class='pull-right hideInPrint' ng-attr-title="{{searchLabel}}" ng-click="filterEvents(eventGridColumn, false, false)">
                                        <span ng-if="!eventGridColumn.filterWithRange" >
                                            <span ng-class="{true: 'filter-without-content', false: 'filter-with-content'} [filterText[eventGridColumn.id] == undefined || filterText[eventGridColumn.id] == '']"><i class="fa fa-search"></i></span>
                                        </span>
                                        <span ng-if="eventGridColumn.filterWithRange">                                            
                                            <span ng-class="{true: 'filter-without-content', false: 'filter-with-content'} [(filterText[eventGridColumn.id].start == undefined || filterText[eventGridColumn.id].start == '') && (filterText[eventGridColumn.id].end == undefined || filterText[eventGridColumn.id].end == '')]"><i class="fa fa-search"></i></span>
                                        </span>                                                    
                                    </span>
                                    <!-- filter icon ends -->

                                    <!-- filter input field begins -->
                                    <span ng-show="eventGridColumn.showFilter">
                                        <span ng-switch="eventGridColumn.valueType">                                            
                                            <span ng-switch-when="NUMBER">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'lower_limit' | translate}}" type="number" ng-model="filterText[eventGridColumn.id].start" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'upper_limit' | translate}}" type="number" ng-model="filterText[eventGridColumn.id].end" ng-blur="filterEvents(eventGridColumn, true, true)">
                                            </span>
                                            <span ng-switch-when="INTEGER">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'lower_limit' | translate}}" type="number" ng-model="filterText[eventGridColumn.id].start" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'upper_limit' | translate}}" type="number" ng-model="filterText[eventGridColumn.id].end" ng-blur="filterEvents(eventGridColumn, true, true)">
                                            </span>
                                            <span ng-switch-when="INTEGER_POSITIVE">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'lower_limit' | translate}}" type="number" min="1" ng-model="filterText[eventGridColumn.id].start" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'upper_limit' | translate}}" type="number" min="1" ng-model="filterText[eventGridColumn.id].end" ng-blur="filterEvents(eventGridColumn, true, true)">
                                            </span>
                                            <span ng-switch-when="INTEGER_NEGATIVE">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'lower_limit' | translate}}" type="number" max="-1" ng-model="filterText[eventGridColumn.id].start" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'upper_limit' | translate}}" type="number" max="-1" ng-model="filterText[eventGridColumn.id].end" ng-blur="filterEvents(eventGridColumn, true, true)">
                                            </span>
                                            <span ng-switch-when="INTEGER_ZERO_OR_POSITIVE">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'lower_limit' | translate}}" type="number" min="0" ng-model="filterText[eventGridColumn.id].start" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <input style="width: 45%;" ng-attr-placeholder="{{'upper_limit' | translate}}" type="number" min="0" ng-model="filterText[eventGridColumn.id].end" ng-blur="filterEvents(eventGridColumn, true, true)">
                                            </span>
                                            <span ng-switch-when="DATE">
                                                <input style="width: 70%;" ng-attr-placeholder="{{'start_date' | translate}}" type="text" ng-model="filterText[eventGridColumn.id].start" d2-date readonly="readonly" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <span ng-hide="!filterText[eventGridColumn.id].start || filterText[eventGridColumn.id].start == undefined || filterText[eventGridColumn.id].start == ''">
                                                    <a href ng-click='removeStartFilterText(eventGridColumn.id)'><span class='black'><i class="fa fa-trash-o"></i></span></a>                                                        
                                                </span>
                                                <input style="width: 70%;" ng-attr-placeholder="{{'end_date' | translate}}" type="text" ng-model="filterText[eventGridColumn.id].end" d2-date readonly="readonly" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                <span ng-hide="!filterText[eventGridColumn.id].end || filterText[eventGridColumn.id].end == undefined || filterText[eventGridColumn.id].end == ''">
                                                    <a href ng-click='removeEndFilterText(eventGridColumn.id)'><span class='black'><i class="fa fa-trash-o"></i></span></a>                                                        
                                                </span> 
                                            </span>
                                            <span ng-switch-when="TEXT">
                                                <span ng-if="prStDes[eventGridColumn.id] && prStDes[eventGridColumn.id].dataElement && prStDes[eventGridColumn.id].dataElement.optionSetValue">
                                                    
                                                    <ui-select multiple
                                                                ng-model="filterText[eventGridColumn.id]"
                                                                ng-click="filterEvents(eventGridColumn, true, true)"
                                                                theme="bootstrap" style="width:90%;">
                                                        <ui-select-match allow-clear="true" ng-attr-placeholder="{{'select_or_search'| translate}}">{{$item.displayName}}</ui-select-match>
                                                        <ui-select-choices repeat="option in optionSets[prStDes[eventGridColumn.id].dataElement.optionSet.id].options | filter: $select.search | limitTo:maxOptionSize">
                                                            <span ng-bind-html="option.displayName | highlight: $select.search"></span>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                    
                                                </span>
                                                
                                                <span ng-if="!prStDes[eventGridColumn.id] || !prStDes[eventGridColumn.id].dataElement.optionSetValue">                                                
                                                    <input type="text" style="width: 90%;" ng-model="filterText[eventGridColumn.id]" ng-blur="filterEvents(eventGridColumn, true, true)">
                                                </span>                                                
                                            </span>
                                            <span ng-switch-default>
                                                <input type="text" style="width: 90%;" ng-model="filterText[eventGridColumn.id]" ng-blur="filterEvents(eventGridColumn, true, true)">
                                            </span> 
                                        </span>
                                        <span ng-if="eventGridColumn.id !== 'uid'">{{eventGridColumn.displayName}}</span>
                                        <span ng-if="eventGridColumn.id == 'uid'">{{eventGridColumn.displayName | translate}}</span>
                                    </span>
                                    <!-- filter input field ends -->                                
                                </th>
                                <!-- visible when comment exisits -->
                                <th ng-repeat="eventGridColumn in eventGridColumns | filter: {show: true}" ng-if="eventGridColumn.id === 'comment'">                                
                                    {{'comment' | translate}}
                                </th>
                                <!-- visible when comment exisits -->
                            </tr>                        
                        </thead>
                        <tbody id="list">
                            <tr ng-attr-title="{{'click_for_action' | translate}}" ng-repeat="dhis2Event in dhis2Events">
                                <!-- Visible when event is not under editing -->
                                <td ng-if="(currentEvent.event !== dhis2Event.event) && (eventGridColumn.id !== 'comment')"  class="no-padding"
                                    d2-context-menu ng-click="showEventList(dhis2Event)" ng-repeat="eventGridColumn in eventGridColumns | filter: {show: true}">
                                    <div class="row-margin">
                                        <span ng-switch="eventGridColumn.valueType">
                                            <span ng-switch-when="BOOLEAN">
                                                <span ng-if="dhis2Event[eventGridColumn.id] == 'false'">{{noLabel}}</span>
                                                <span ng-if="dhis2Event[eventGridColumn.id] == 'true'">{{yesLabel}}</span>
                                            </span>
                                            <span ng-switch-when="TRUE_ONLY">
                                                <span ng-if="dhis2Event[eventGridColumn.id]">{{yesLabel}}</span>
                                            </span>
                                            <span ng-switch-when="FILE_RESOURCE">
                                                <a href ng-click="downloadFile(dhis2Event.event, eventGridColumn.id, $event)">{{fileNames[dhis2Event.event][eventGridColumn.id]}}</a>
                                            </span>
                                            <span ng-switch-when="IMAGE">
                                                <d2-image-in-list d2-event-id="dhis2Event.event" d2-de-id="eventGridColumn.id">
                                                </d2-image-in-list>
                                            </span>
                                            <span ng-switch-when="ORGANISATION_UNIT">
                                                {{orgUnitNames[dhis2Event[eventGridColumn.id]]}}
                                            </span>
                                            <span ng-switch-when="AGE">
                                                {{dhis2Event[eventGridColumn.id] | parseAge}}
                                            </span>
                                            <div ng-switch-when="DATE">
                                                <span ng-if="eventGridColumn.id !== 'lastUpdated' && eventGridColumn.id !== 'eventDate'">{{dhis2Event[eventGridColumn.id]}}</span>
                                                <span ng-if="eventGridColumn.id === 'lastUpdated'">{{formatCalendar(dhis2Event[eventGridColumn.id])}}</span>
                                                <span ng-if="eventGridColumn.id === 'eventDate'">{{formatCalendar(dhis2Event[eventGridColumn.id])}}</span>
                                            </div>
                                            <span ng-switch-default>
                                                {{dhis2Event[eventGridColumn.id]}}
                                            </span>
                                        </span>
                                        <span ng-if="!dhis2Event[eventGridColumn.id] || dhis2Event[eventGridColumn.id] === ''">
                                            &nbsp;&nbsp;
                                        </span>
                                    </div>
                                </td>
                                <!-- Visible when event is not under editing -->

                                <!-- Visible when event is under editing in grid -->
                                <td ng-if="editingEventInGrid && (currentEvent.event === dhis2Event.event) && (eventGridColumn.id !== 'comment')" ng-repeat="eventGridColumn in eventGridColumns | filter: {show: true}">
                                    <div  style="cursor:default;">
                                        <ng-form name="innerListForm">
                                            <div ng-if="eventGridColumn.id === 'uid'">
                                                <input type="text"
                                                        ng-model="currentEvent[eventGridColumn.id]"                                                                    
                                                        ng-disabled=true 
                                                        name="foo" 
                                                        class="form-control"/>
                                            </div>
                                            <div ng-if="eventGridColumn.id !== 'uid'">
                                                <div ng-if="prStDes[eventGridColumn.id].dataElement.optionSetValue">
                                                    <ui-select ng-model="currentEvent[eventGridColumn.id]" 
                                                               theme="select2" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               name="foo" 
                                                               d2-option-validator
                                                               on-select="updateEventDataValue(eventGridColumn.id, currentEvent)" 
                                                               on-remove="validateOptionOnRemove(eventGridColumn.compulsory)"
                                                               input-field-id={{eventGridColumn.id}}                                                               
                                                               style="width:100%;">
                                                        <ui-select-match allow-clear="true" 
                                                                         class="form-control-ui-select" 
                                                                         ng-class="getInputNotifcationClass(eventGridColumn.id, true)" 
                                                                         ng-attr-placeholder="{{'select_or_search' | translate}}">
                                                            {{$select.selected.displayName || $select.selected}}
                                                        </ui-select-match>
                                                        <ui-select-choices  repeat="option.displayName as option in optionSets[prStDes[eventGridColumn.id].dataElement.optionSet.id].options | filter: $select.search | limitTo:maxOptionSize">
                                                            <span ng-bind-html="option.displayName | highlight: $select.search"></span>
                                                        </ui-select-choices>
                                                    </ui-select>
                                                </div>
                                                <div ng-if="!prStDes[eventGridColumn.id].dataElement.optionSetValue" ng-switch="eventGridColumn.valueType">                                            
                                                    <div ng-switch-when="NUMBER">
                                                        <input type="number"   
                                                                ng-hide="hiddenFields[eventGridColumn.id]"                                                         
                                                               d2-number-validator
                                                               number-type={{prStDes[eventGridColumn.id].dataElement.numberType}}
                                                               ng-model="currentEvent[eventGridColumn.id]" 
                                                               ng-blur="updateEventDataValue(eventGridColumn.id, currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}} 
                                                               name="foo" 
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>
                                                    </div>
                                                    <div ng-switch-when="PERCENTAGE">
                                                        <input type="number"
                                                               ng-hide="hiddenFields[eventGridColumn.id]"
                                                               d2-number-validator
                                                               number-type={{prStDes[eventGridColumn.id].dataElement.numberType}}
                                                               ng-model="currentEvent[eventGridColumn.id]"
                                                               ng-blur="updateEventDataValue(eventGridColumn.id, currentEvent)"
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}}
                                                               name="foo"
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>
                                                    </div>
                                                    <div ng-switch-when="INTEGER">
                                                        <input type="number"   
                                                                ng-hide="hiddenFields[eventGridColumn.id]"                                                         
                                                               d2-number-validator
                                                               number-type={{prStDes[eventGridColumn.id].dataElement.numberType}}
                                                               ng-model="currentEvent[eventGridColumn.id]" 
                                                               ng-blur="updateEventDataValue(eventGridColumn.id,currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}} 
                                                               name="foo" 
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>
                                                    </div>
                                                    <div ng-switch-when="INTEGER_POSITIVE">
                                                        <input type="number" 
                                                                ng-hide="hiddenFields[eventGridColumn.id]"                                                           
                                                               d2-number-validator
                                                               number-type={{prStDes[eventGridColumn.id].dataElement.numberType}}
                                                               ng-model="currentEvent[eventGridColumn.id]" 
                                                               ng-blur="updateEventDataValue(eventGridColumn.id,currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}} 
                                                               name="foo" 
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>
                                                    </div>
                                                    <div ng-switch-when="INTEGER_NEGATIVE">
                                                        <input type="number"                                                            
                                                               d2-number-validator
                                                               number-type={{prStDes[eventGridColumn.id].dataElement.numberType}}
                                                               ng-model="currentEvent[eventGridColumn.id]" 
                                                               ng-blur="updateEventDataValue(eventGridColumn.id,currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}} 
                                                               name="foo" 
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>
                                                    </div>
                                                    <div ng-switch-when="INTEGER_ZERO_OR_POSITIVE">
                                                        <input type="number"   
                                                                ng-hide="hiddenFields[eventGridColumn.id]"                                                         
                                                               d2-number-validator
                                                               number-type={{prStDes[eventGridColumn.id].dataElement.numberType}}
                                                               ng-model="currentEvent[eventGridColumn.id]" 
                                                               ng-blur="updateEventDataValue(eventGridColumn.id,currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}} 
                                                               name="foo" 
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>
                                                    </div>
                                                    <div ng-switch-when="AGE">
                                                        <d2-age id="{{eventGridColumn.id}}"
                                                                ng-hide="hiddenFields[eventGridColumn.id]" 
                                                                d2-age-saved="currentElement.updated && currentElement.id === eventGridColumn.id"
                                                                d2-object="currentEvent" 
                                                                d2-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                d2-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                d2-function="updateEventDataValue(eventGridColumn.id,currentEvent)">                                                    
                                                        </d2-age>
                                                    </div>
                                                    <div ng-switch-when="PHONE_NUMBER">
                                                        <input type="text"
                                                                ng-hide="hiddenFields[eventGridColumn.id]"
                                                                ng-model="currentEvent[eventGridColumn.id]"                                        
                                                                ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                name="foo" 
                                                                input-field-id={{eventGridColumn.id}} 
                                                                ng-blur="updateEventDataValue(eventGridColumn.id, currentEvent)" 
                                                                class="form-control"/>
                                                    </div>
                                                    <div ng-switch-when="LONG_TEXT">                                        
                                                        <textarea rows="3"
                                                                ng-hide="hiddenFields[eventGridColumn.id]"
                                                                ng-model="currentEvent[eventGridColumn.id]"                                        
                                                                ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                ng-blur="updateEventDataValue(eventGridColumn.id,currentEvent)" 
                                                                name="foo" 
                                                                input-field-id={{eventGridColumn.id}} 
                                                                ng-class="getInputNotifcationClass(eventGridColumn.id,false)">
                                                            </textarea>
                                                    </div>
                                                    <div ng-switch-when="TEXT">
                                                        <input type="text"
                                                                   ng-hide="hiddenFields[eventGridColumn.id]"
                                                                   ng-model="currentEvent[eventGridColumn.id]" 
                                                                   ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                   ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                   ng-blur="updateEventDataValue(eventGridColumn.id, currentEvent)" 
                                                                   name="foo" 
                                                                   ng-class="getInputNotifcationClass(eventGridColumn.id,false)"/>                                                    
                                                    </div>
                                                    <div ng-switch-when="BOOLEAN" ng-cloak>
                                                        <d2-radio-button
                                                            ng-hide="hiddenFields[eventGridColumn.id]"
                                                            class="form-control"
                                                            ng-cloak
                                                            dh-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                            dh-disabled="assignedFields[eventGridColumn.id] || model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                            dh-value="currentEvent[eventGridColumn.id]"
                                                            dh-name="foo"
                                                            dh-event="currentEvent.event"
                                                            dh-current-element="currentElement"
                                                            dh-click="updateEventDataValueRadio(eventGridColumn.id, currentEvent, value)"
                                                            dh-id="eventGridColumn.id">
                                                        </d2-radio-button>
                                                    </div>
                                                    <div ng-switch-when="DATE">
                                                        <input type="text" 
                                                               ng-hide="hiddenFields[eventGridColumn.id]"
                                                               ng-attr-placeholder="{{dhis2CalendarFormat.keyDateFormat}}"
                                                               d2-date
                                                               max-date="prStDes[eventGridColumn.id].allowFutureDate ? '' : 0" 
                                                               d2-date-validator
                                                               ng-model="currentEvent[eventGridColumn.id]"
                                                               blur-or-change="eventGridColumn.id === 'eventDate' ? updateEventDate() : updateEventDataValue(eventGridColumn.id, currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                               input-field-id={{eventGridColumn.id}}                                                            
                                                               ng-class="getInputNotifcationClass(eventGridColumn.id,false)"
                                                               ng-disabled="model.editingDisabled || eventGridColumn.id === 'lastUpdated' || hiddenFields[eventGridColumn.id]"
                                                               name="foo"/>
                                                    </div>
                                                    <div ng-switch-when="DATETIME">
                                                        <d2-date-time datetime-model="currentEvent"
                                                                      datetime-model-id="eventGridColumn.id"
                                                                      datetime-date-placeholder="{{dhis2CalendarFormat.keyDateFormat}}"
                                                                      datetime-max-date="prStDes[de.id].allowFutureDate ? '' : 0"
                                                                      datetime-required="eventGridColumn.compulsory"
                                                                      datetime-save-methode="updateEventDataValue"
                                                                      datetime-save-methode-parameter1="eventGridColumn.id"
                                                                      datetime-save-methode-parameter2="currentEvent"
                                                                      datetime-element="currentElement"
                                                                      datetime-disable-popup="true"
                                                                      datetime-use-notification="true"
                                                                      datetime-disabled="model.editingDisabled"
                                                                      datetime-outerform="outerDataEntryForm">
                                                        </d2-date-time>
                                                    </div>
                                                    <div ng-switch-when="TIME">
                                                        <d2-time time-model="currentEvent"
                                                                 time-model-id="eventGridColumn.id"
                                                                 time-required="eventGridColumn.compulsory"
                                                                 time-save-methode="updateEventDataValue"
                                                                 time-save-methode-parameter1="eventGridColumn.id"
                                                                 time-save-methode-parameter2="currentEvent"
                                                                 time-element="currentElement"
                                                                 time-use-notification="true"
                                                                 time-disabled="model.editingDisabled"
                                                                 time-format="timeFormat">
                                                        </d2-time>
                                                    </div>
                                                    <div ng-switch-when="USERNAME" ng-hide="hiddenFields[eventGridColumn.id]">
                                                        <d2-users-input d2-model="currentEvent"
                                                                        d2-model-id="eventGridColumn.id"
                                                                        d2-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                        d2-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                        d2-save-methode="updateEventDataValue"
                                                                        d2-save-methode-parameter1="eventGridColumn.id"
                                                                        d2-save-methode-parameter2="currentEvent"
                                                                        d2-max-option-size="maxOptionSize"
                                                                        d2-use-notification="true"
                                                                        d2-element="eventGridColumn.id">
                                                        </d2-users-input>
                                                    </div>
                                                    <div ng-switch-when="TRUE_ONLY">
                                                        <input type="checkbox"
                                                               ng-hide="hiddenFields[eventGridColumn.id]"
                                                               d2-validation 
                                                               ng-model="currentEvent[eventGridColumn.id]"
                                                               ng-change="updateEventDataValue(eventGridColumn.id, currentEvent)" 
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]" 
                                                               input-field-id={{eventGridColumn.id}}
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               name="foo"/>
                                                    </div>
                                                    <div ng-switch-when="FILE_RESOURCE">                                
                                                        <div class="input-group" ng-hide="hiddenFields[eventGridColumn.id]">
                                                            <div class="form-control">
                                                                <a href ng-click="downloadFile(currentEvent.event, eventGridColumn.id, $event)">{{fileNames[currentEvent.event][eventGridColumn.id]}}</a>
                                                            </div>
                                                            <span class="input-group-btn">
                                                                <span class="btn btn-primary btn-file" ng-if="currentEvent[eventGridColumn.id]" ng-click="deleteFileFromGrid(currentEvent, eventGridColumn.id)">
                                                                    <span
                                                                        ng-attr-title="{{'delete_file' | translate}}" 
                                                                        d2-file-input-name="fileNames[currentEvent.event][eventGridColumn.id]" 
                                                                        d2-file-input-delete="currentEvent[eventGridColumn.id]"
                                                                    >
                                                                        <i class="fa fa-trash alert-danger"></i>
                                                                    </span>
                                                                </span>
                                                                <span class="btn btn-primary btn-file" ng-if="!currentEvent[eventGridColumn.id]" ng-attr-title="{{'upload' | translate}}">
                                                                    <i class="fa fa-upload"></i>
                                                                    <input type="file" 
                                                                            ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                            ng-disabled="assignedFields[eventGridColumn.id] || model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                            name="foo"
                                                                            input-field-id={{eventGridColumn.id}}
                                                                            d2-file-input-list="dhis2Events"
                                                                            d2-file-input-ps="selectedProgramStage"
                                                                            d2-file-input-instant="true"
                                                                            d2-file-input="currentEvent" 
                                                                            d2-file-input-current-name="currentFileNames"
                                                                            d2-file-input-name="fileNames">
                                                                </span>
                                                            </span>                
                                                        </div>
                                                    </div>
                                                    <div ng-switch-when="IMAGE">
                                                        <d2-image-in-list d2-event-id="currentEvent.event" d2-de-id="eventGridColumn.id">
                                                        </d2-image-in-list>
                                                    </div>
                                                    <div ng-switch-when="COORDINATE">
                                                        <d2-map id="{{eventGridColumn.id}}"
                                                                ng-hide="hiddenFields[eventGridColumn.id]"
                                                                d2-lat-saved="currentElement.updated && currentElement.id === eventGridColumn.id"
                                                                d2-lng-saved="currentElement.updated && currentElement.id === eventGridColumn.id"
                                                                d2-object="currentEvent" 
                                                                d2-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                d2-disabled="assignedFields[eventGridColumn.id] || model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                d2-function="updateEventDataValue(arg1)" 
                                                                d2-coordinate-format="'TEXT'"
                                                                d2-function-param-text="eventGridColumn.id">
                                                        </d2-map>
                                                    </div>
                                                    <div ng-switch-when="ORGANISATION_UNIT">
                                                        <d2-org-unit-tree
                                                                ng-hide="hiddenFields[eventGridColumn.id]"
                                                                selected-org-unit-id="{{selectedOrgUnit.id}}"
                                                                id="{{eventGridColumn.id}}"
                                                                d2-value="currentEvent[eventGridColumn.id]"
                                                                d2-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                d2-disabled="assignedFields[eventGridColumn.id] || model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                d2-object="currentEvent"
                                                                d2-function="updateEventDataValue(eventGridColumn.id, currentEvent)"
                                                                d2-orgunit-names="orgUnitNames">
                                                        </d2-org-unit-tree>
                                                    </div>                                                
                                                    <div ng-switch-when="EMAIL">
                                                        <input type="email"
                                                               ng-hide="hiddenFields[eventGridColumn.id]"
                                                               name="foo"
                                                               class="form-control"
                                                               ng-model="currentEvent[eventGridColumn.id]"
                                                               ng-model-options="{ updateOn: 'default blur', allowInvalid: true }"
                                                               selected-program-id={{selectedProgram.id}}
                                                               ng-disabled="model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                               ng-blur="updateEventDataValue(eventGridColumn.id, currentEvent)"
                                                               ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"/>
                                                    </div>
                                                    <div ng-switch-when="URL">
                                                        <div class="hideInPrint">
                                                            <input type="url"
                                                                   ng-hide="hiddenFields[eventGridColumn.id]"
                                                                   ng-attr-placeholder="{{'url_format' | translate}}"
                                                                   class="form-control"
                                                                   ng-pattern="/^(http|https):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}(:[0-9]{1,5})?(\/.*)?$/"
                                                                   ng-model="currentEvent[eventGridColumn.id]"
                                                                   ng-required="eventGridColumn.compulsory || mandatoryFields[eventGridColumn.id]"
                                                                   ng-disabled="assignedFields[eventGridColumn.id] || model.editingDisabled || hiddenFields[eventGridColumn.id]"
                                                                   ng-blur="updateEventDataValue(eventGridColumn.id, currentEvent)"
                                                                   name="foo"/>
                                                        </div>
                                                    </div>
                                                    <div ng-switch-default>
                                                        <div class="alert alert-danger form-control">
                                                            {{'unsupported_value_type' | translate}}:  {{eventGridColumn.valueType}}
                                                        </div>                                          
                                                    </div>                                                    
                                                    <div ng-messages="innerListForm.foo.$error" ng-if="interacted(innerListForm.foo)" class="required" ng-messages-include="../dhis-web-commons/angular-forms/error-messages.html">
                                                    </div>
                                                </div>
                                            </div>                                                                         
                                        </ng-form>
                                    </div>
                                </td>
                                <td ng-if="editingEventInGrid && (currentEvent.event === dhis2Event.event) && (eventGridColumn.id !== 'comment') && warningMessages.length > 0" style="background-color: white; border: none; padding-left: 10px;">
                                    <span style="font-weight:bold"><i class="fa fa-exclamation-triangle" style="color: #FFCC00"></i> {{'validation_warnings'| translate}}:</span>
                                    <ul style="padding-left: 15px">
                                        <li ng-repeat="msg in warningMessages">{{msg}}</li>
                                    </ul>
                                </td>

                                <!-- Visible when event is under editing in grid -->

                                <!-- visible when comment exisits -->
                                <td ng-repeat="eventGridColumn in eventGridColumns | filter: {show: true}" ng-if="eventGridColumn.id === 'comment'">
                                    <a href ng-click="showNotes(dhis2Event)" ng-attr-title="{{'show_comments'| translate}}" ng-if="dhis2Event.notes.length > 0"><i class="fa fa-info-circle"></i></a>
                                </td>
                                <!-- visible when comment exisits -->
                            </tr>
                        </tbody>        
                    </table>

                    <serverside-paginator></serverside-paginator>
                </form>
            </div>
            
            <!-- grid ends -->
        </div>
    </div>
</div> 